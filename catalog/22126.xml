<?xml version="1.0" encoding="UTF-8"?>
<xml><thread id="22126"><title>The IK froggy walk?</title><posts><post id="p206900" date="Posted: Thu Oct 30, 2008 5:09 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Did anyone encountered a strange animation deformation that happen when you enable legs IK, that make your custom character walking like a frog?<br /><br />By walking like a frog i mean: the knee go to the exterior while the ankle is going up, and then back pointing in front of the character while the ankle going down...<br /><br />Doom3 IK is something i don't know very well.<br />If someone can help me to understand the very basics, this would be 'kewl'  <img src="https://web.archive.org/web/20081121035753im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />a few questions:<br />A) What is "anim ik_pose" used for exactly?<br />B) What are "ik_footUpTrace", "ik_footDownTrace" and "ik_liftWaist" for?<br />C) What are "ik_numArms" (&amp; co) usefull for? (i mean is it used when the player fall, when the player is against a wall, or something like that?)<br />D) Is there some "rules" to respect to have a fully workable IK, like never do x thing in your animations? (like put the ankle upper than the knee for exemple...)<br /><br />Thanks for any infos!</div>]]></body></post><post id="p206914" date="Posted: Thu Oct 30, 2008 9:58 pm "><author>der_ton</author><body><![CDATA[<div class="postbody">There are helper bones in the skeletons that are referenced in the ik portion of an entity definition. They tell the engine the directions in which a joint should move when it is to be moved by ik. For example the imp has RKnee and LKnee bones in the md5mesh file for that purpose, they are positioned outside of the body infront of the actual knee bones.<br /><br />A related thread that might have some hints: <!-- l --><a class="postlink-local" href="https://web.archive.org/web/20081121035753/http://www.doom3world.org/phpbb2/viewtopic.php?f=3&amp;t=20904&amp;p=192423">viewtopic.php?f=3&amp;t=20904&amp;p=192423</a><!-- l --></div>]]></body></post><post id="p206915" date="Posted: Thu Oct 30, 2008 10:44 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Hey, thank you!<br /><br />I managed to solve my problem early in the evening.<br />I found that the IK_pose anim got to have legs oriented in the direction you want these to be by the IK when walking/running, plus if you look carefully at this anim too, you'll see that Lknee &amp; Rknee are far away from the rest of the body, in the "right" direction/orientation for legs.<br /><br />Looking at the sdk, i think i understood that the walk anim is combined with a modified IK_pose anim, modified by the IK system itself.<br />So you got to do an IK_pose very similar to the way your character walk/run (usually a T pose) and not use an initial star pose (isolated legs &amp; arms).<br /><br />Still missing the arms IK use...  <img src="https://web.archive.org/web/20081121035753im_/http://www.doom3world.org/phpbb2/images/smilies/icon_confused.gif" alt=":?" title="Confused" /></div>]]></body></post><post id="p206931" date="Posted: Fri Oct 31, 2008 7:27 am "><author>BloodRayne</author><body><![CDATA[<div class="postbody">We've encountered all of these issues with IK and more with Edge of Chaos. And I'm not sure if we've even solved them, allthough all of our anims look good now in game. We've fiddled with this for months on end. Trying to get a custom creature with good IK but there is very little information on it available.<br /><br />The code below works fine, but as soon as we uncomment the IK_Dir keys things go terribly wrong, the feet end up underground, as if the bones are placed wrong. If anyone has *any* ideas on how to solve this. I'd be greatly appreciative. <img src="https://web.archive.org/web/20081121035753im_/http://www.doom3world.org/phpbb2/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">   "ik_numLegs"               "2"<br />   "ik_footSize"               "16"<br />   "ik_waist"               "Hips"<br />   "ik_hip1"               "Lupleg"<br />   "ik_hip2"               "Rupleg"<br />   "ik_knee1"               "Lloleg"<br />   "ik_knee2"               "Rloleg"<br />   "ik_ankle1"               "Lball_r"<br />   "ik_ankle2"               "Rball_r"<br />   <br />   //this works, but feet go underground.<br />   //"ik_dir1"               "ltip_r"<br />   //"ik_dir2"               "rtip_r"<br />   <br />   "ik_foot1"               "Rtoe1_r"<br />   "ik_foot2"               "Ltoe2_r"<br /></div></div>]]></body></post><post id="p206934" date="Posted: Fri Oct 31, 2008 9:15 am "><author>der_ton</author><body><![CDATA[<div class="postbody">Where are those ltip_r and rtip_r bones placed? Do you have a screenshot with the skeleton and the bone names?<br />I've taken a look at the SDK's IK.cpp. The bones used as ik_dir are used automatically by the engine in relation to the respective ik_knee bones (only the helper bone's position is used, the orientation seems not to be relevant). They are helpers to determine where to move the knee, and can't be used as a target for any other bone.<br /><br />I only took a quick glance at this, and I've never played around with that stuff with practical experience. If you have a coder, he might be able to understand from the ik.cpp how the ik stuff in the def file is supposed to be set up.<br /><!-- m --><a class="postlink" href="https://web.archive.org/web/20081121035753/http://www.koders.com/cpp/fidDB6CEB7E30E3B37B45D917F3639E05E058CE13E0.aspx?s=dirJoints#L12">http://www.koders.com/cpp/fidDB6CEB7E30 ... Joints#L12</a><!-- m --></div>]]></body></post><post id="p206900" date="Posted: Thu Oct 30, 2008 5:09 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Did anyone encountered a strange animation deformation that happen when you enable legs IK, that make your custom character walking like a frog?<br /><br />By walking like a frog i mean: the knee go to the exterior while the ankle is going up, and then back pointing in front of the character while the ankle going down...<br /><br />Doom3 IK is something i don't know very well.<br />If someone can help me to understand the very basics, this would be 'kewl'  <img src="https://web.archive.org/web/20081121040608im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /><br /><br />a few questions:<br />A) What is "anim ik_pose" used for exactly?<br />B) What are "ik_footUpTrace", "ik_footDownTrace" and "ik_liftWaist" for?<br />C) What are "ik_numArms" (&amp; co) usefull for? (i mean is it used when the player fall, when the player is against a wall, or something like that?)<br />D) Is there some "rules" to respect to have a fully workable IK, like never do x thing in your animations? (like put the ankle upper than the knee for exemple...)<br /><br />Thanks for any infos!</div>]]></body></post><post id="p206914" date="Posted: Thu Oct 30, 2008 9:58 pm "><author>der_ton</author><body><![CDATA[<div class="postbody">There are helper bones in the skeletons that are referenced in the ik portion of an entity definition. They tell the engine the directions in which a joint should move when it is to be moved by ik. For example the imp has RKnee and LKnee bones in the md5mesh file for that purpose, they are positioned outside of the body infront of the actual knee bones.<br /><br />A related thread that might have some hints: <!-- l --><a class="postlink-local" href="https://web.archive.org/web/20081121040608/http://www.doom3world.org/phpbb2/viewtopic.php?f=3&amp;t=20904&amp;p=192423">viewtopic.php?f=3&amp;t=20904&amp;p=192423</a><!-- l --></div>]]></body></post><post id="p206915" date="Posted: Thu Oct 30, 2008 10:44 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Hey, thank you!<br /><br />I managed to solve my problem early in the evening.<br />I found that the IK_pose anim got to have legs oriented in the direction you want these to be by the IK when walking/running, plus if you look carefully at this anim too, you'll see that Lknee &amp; Rknee are far away from the rest of the body, in the "right" direction/orientation for legs.<br /><br />Looking at the sdk, i think i understood that the walk anim is combined with a modified IK_pose anim, modified by the IK system itself.<br />So you got to do an IK_pose very similar to the way your character walk/run (usually a T pose) and not use an initial star pose (isolated legs &amp; arms).<br /><br />Still missing the arms IK use...  <img src="https://web.archive.org/web/20081121040608im_/http://www.doom3world.org/phpbb2/images/smilies/icon_confused.gif" alt=":?" title="Confused" /></div>]]></body></post><post id="p206931" date="Posted: Fri Oct 31, 2008 7:27 am "><author>BloodRayne</author><body><![CDATA[<div class="postbody">We've encountered all of these issues with IK and more with Edge of Chaos. And I'm not sure if we've even solved them, allthough all of our anims look good now in game. We've fiddled with this for months on end. Trying to get a custom creature with good IK but there is very little information on it available.<br /><br />The code below works fine, but as soon as we uncomment the IK_Dir keys things go terribly wrong, the feet end up underground, as if the bones are placed wrong. If anyone has *any* ideas on how to solve this. I'd be greatly appreciative. <img src="https://web.archive.org/web/20081121040608im_/http://www.doom3world.org/phpbb2/images/smilies/icon_smile.gif" alt=":)" title="Smile" /><br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">   "ik_numLegs"               "2"<br />   "ik_footSize"               "16"<br />   "ik_waist"               "Hips"<br />   "ik_hip1"               "Lupleg"<br />   "ik_hip2"               "Rupleg"<br />   "ik_knee1"               "Lloleg"<br />   "ik_knee2"               "Rloleg"<br />   "ik_ankle1"               "Lball_r"<br />   "ik_ankle2"               "Rball_r"<br />   <br />   //this works, but feet go underground.<br />   //"ik_dir1"               "ltip_r"<br />   //"ik_dir2"               "rtip_r"<br />   <br />   "ik_foot1"               "Rtoe1_r"<br />   "ik_foot2"               "Ltoe2_r"<br /></div></div>]]></body></post><post id="p206934" date="Posted: Fri Oct 31, 2008 9:15 am "><author>der_ton</author><body><![CDATA[<div class="postbody">Where are those ltip_r and rtip_r bones placed? Do you have a screenshot with the skeleton and the bone names?<br />I've taken a look at the SDK's IK.cpp. The bones used as ik_dir are used automatically by the engine in relation to the respective ik_knee bones (only the helper bone's position is used, the orientation seems not to be relevant). They are helpers to determine where to move the knee, and can't be used as a target for any other bone.<br /><br />I only took a quick glance at this, and I've never played around with that stuff with practical experience. If you have a coder, he might be able to understand from the ik.cpp how the ik stuff in the def file is supposed to be set up.<br /><!-- m --><a class="postlink" href="https://web.archive.org/web/20081121040608/http://www.koders.com/cpp/fidDB6CEB7E30E3B37B45D917F3639E05E058CE13E0.aspx?s=dirJoints#L12">http://www.koders.com/cpp/fidDB6CEB7E30 ... Joints#L12</a><!-- m --></div>]]></body></post></posts></thread></xml>
