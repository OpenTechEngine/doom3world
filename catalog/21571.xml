<?xml version="1.0" encoding="UTF-8"?>
<xml><thread id="21571"><title>[Quake4] Alpha channel in different image file?</title><posts><post id="p199571" date="Posted: Thu May 29, 2008 5:37 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">hey<br />currently I'm adding a texture via blend to a model like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"> ..<br />    {<br />        nopicmip<br />        blend   blend<br />        map     models/bla.tga<br />    }<br />..</div><br />the image has its alpha channel.. but since I have multiple of these stages in one shader, which use all the same texture, just a different alpha channel, would it be possible to have the alpha channel in a different file ?</div>]]></body></post><post id="p199590" date="Posted: Fri May 30, 2008 6:06 am "><author>rich_is_bored</author><body><![CDATA[<div class="postbody">Use the <a href="https://web.archive.org/web/20081121083022/http://www.modwiki.net/wiki/MaskColor_(Material_stage_keyword)" class="postlink">maskcolor</a> and <a href="https://web.archive.org/web/20081121083022/http://www.modwiki.net/wiki/MaskAlpha_(Material_stage_keyword)" class="postlink">maskalpha</a> keywords.</div>]]></body></post><post id="p199592" date="Posted: Fri May 30, 2008 11:38 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">thanx..<br />though I can't get it to work...<br />my code:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">    {<br />        nopicmip<br />        blend   blend<br />        map     basetexture.tga<br />        color   1, 0, 0, 1 // red<br />    }<br />    // first mask<br />    {<br />        maskcolor<br />        map alpha1.tga<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        maskalpha<br />        map texture.tga<br />        color   0, 1, 0, 1 // green<br />    }<br />    // second mask<br />    {<br />        maskcolor<br />        map alpha2.tga<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        maskalpha<br />        map texture.tga<br />        color   0, 0, 1, 1 // blue<br />    }</div><br />now what happens: the blue stage is drawn all over the model, alpha images seem to be completely ignored..<br />had the alpha images as normal textures first, then I added it to the alpha channel as well, but still wouldn't work.</div>]]></body></post><post id="p199594" date="Posted: Fri May 30, 2008 12:30 pm "><author>simulation</author><body><![CDATA[<div class="postbody">Not sure that maskalpha and maskcolor will do what you want here. I think they just prevent a channel from being written to "dst".<br /><br />If your red, green and blue textures all have zeros in the alpha channel (or no perhaps no alpha?) and you could try this..<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">{<br />    blend    blend<br />    map      add(red_texture.tga, alpha.tga)<br />    rgba     1,0,0,1<br />}<br />{<br />    blend    blend<br />    map      add(green_texture.tga, alpha.tga)<br />    rgba     0,1,0,1<br />}<br />{<br />    blend    blend<br />    map      add(blue_texture.tga, alpha.tga)<br />    rgba     0,0,1,1<br />}</div>No idea of this works, I'm not in a position to test right this second.</div>]]></body></post><post id="p199595" date="Posted: Fri May 30, 2008 1:08 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">thanx, at least partial success.. it does work.. but only if both texture.tga and alpha.tga are RGBA images,<br />which costs a lot of space, any way to do it with RGB for texture.tga and Grayscale for alpha.tga ?</div>]]></body></post><post id="p199596" date="Posted: Fri May 30, 2008 1:55 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">thanx, at least partial success.. it does work.. but only if both texture.tga and alpha.tga are RGBA images,<br />which costs a lot of space, any way to do it with RGB for texture.tga and Grayscale for alpha.tga ?</div><br /><br />Probably not, if you've tried and it didn't work. When you talk of 'cost' do you mean purely on disk space? The final three compostite "map" textures will be red+alpha, green+alpha and blue+alpha and will each take up the same space irrespective of how they are generated.<br /><br />I'm pretty sure these add() maps must be created when the stage is parsed during first use of the material and don't change from that point on. The constituent four images can then be discarded from whatever resource pool manages images as they're no longer needed in their own right. I'm assuming that things work in this way, as it would explain why the scale() function will only accept constants for its scale factors; this implies a "one off" process to me.<br /><br />Edit: Just re-read your post and I think I may have missed something. Are the three "coloured" textures the same physical TGA or are you attempting to blend the RGB channels from three seperate images? I'm assuming the latter, otherwise you could just use one RGBA image for everything and this wouldn't be an issue.</div>]]></body></post><post id="p199597" date="Posted: Fri May 30, 2008 1:59 pm "><author>lowdragon</author><body><![CDATA[<div class="postbody">wouldnt it work by define an alpha stage and blend the textures in, like<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// ..<br />{<br />blend gl_zero, gl_one<br />map makeAlpha (path/to/texture) //rgb image 1<br />}<br />{<br />blend gl_one, gl_one_minus_src_alpha<br />diffusemap (path/to/texture)<br />}<br />// ..<br /></div></div>]]></body></post><post id="p199598" date="Posted: Fri May 30, 2008 2:00 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">yeah, talking about diskspace.. I don't want my mod to grow too much in size, it is already pretty big.</div>]]></body></post><post id="p199600" date="Posted: Fri May 30, 2008 2:32 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">yeah, talking about diskspace.. I don't want my mod to grow too much in size, it is already pretty big.</div><br />Yes, I'm doing a texture elimination exercise to make EMZ smaller in the next release. Anything non-essential that was just put in "because we can" is being ditched.</div>]]></body></post><post id="p199606" date="Posted: Fri May 30, 2008 5:04 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody"><div class="quotetitle">simulation wrote:</div><div class="quotecontent">Edit: Just re-read your post and I think I may have missed something. Are the three "coloured" textures the same physical TGA or are you attempting to blend the RGB channels from three seperate images? I'm assuming the latter, otherwise you could just use one RGBA image for everything and this wouldn't be an issue.</div><br />I have one texture file, that is colored by the material, and 2 alpha files to select what is drawn in what color.<br />in other words, I want to draw different parts of one image in different colors.. so no it's not possible with one rgba file.<br /><br />@lowdragon:<br />no, doesn't work, seems like alpha is a full white image then.</div>]]></body></post><post id="p199607" date="Posted: Fri May 30, 2008 5:54 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">I have one texture file, that is colored by the material, and 2 alpha files to select what is drawn in what color.<br />in other words, I want to draw different parts of one image in different colors.. so no it's not possible with one rgba file.</div><br />I think you could achieve this with a RGBA texture that basicly represent your AColor and Bcolor in white plus the alpha channel, then you could substract 2 different "filter" passes, one for the AColor, and the other one for BColor.<br /><br />Just keep in mind that you must substract the inverted color you want:<br />Red = White - (Blue + Green) =&gt; so to make your Acolor become Red, you must "filter" a turquoise color.<br /><br />Also remember that everything that MUST NOT be affected by the filter map must be white (white will never be substracted in "filter" stages of a material)</div>]]></body></post><post id="p199609" date="Posted: Fri May 30, 2008 7:46 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">ah, now I get it.. that sounds like it could work, I'm going to try it, thanx.</div>]]></body></post><post id="p199610" date="Posted: Fri May 30, 2008 9:04 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">hm tried the following:<br />made an RGBA image, which had the alpha data from part1 in the red channel and the alpha data from part 2 in the green channel, and the alpha channel was used for the texture to be colored..<br />as long as I would want to use only predefined colors, this would probably work, but the colors I want to use here are not predefined, they are passed via shaderparms, and when I try to modify the color afterwards, then I can only get shades of red or green, depending on what channel I used for the part to be colored...<br />on the other hand, I dont have much of a clue how to use the blending functions, so I guess Im probably just too stupid to find out the right way :\<br />help?</div>]]></body></post><post id="p199611" date="Posted: Fri May 30, 2008 10:36 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">You should do something like this:<br /><!-- l --><a class="postlink-local" href="https://web.archive.org/web/20081121083022/http://www.doom3world.org/phpbb2/download/file.php?mode=view&amp;id=111">download/file.php?mode=view&amp;id=111</a><!-- l --><br />pict1.png<br />(FINAL is what you should have in D3, with a material that blend/diffuse the RGBA pict, then a Filter 1 and a Filter 2)<br /><img src="https://web.archive.org/web/20081121083022im_/http://www.doom3world.org/phpbb2/images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>]]></body></post><post id="p199612" date="Posted: Sat May 31, 2008 12:15 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">how am I supposed to create a filter like that using shaderparms?<br />when using the color keyword, white parts get colored, the only way I could imagine this to work is with 2 stages just for the filter, one for the color and one for the white part.. but I dont think thats what you meant, right?</div>]]></body></post><post id="p199618" date="Posted: Sat May 31, 2008 8:30 am "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">how am I supposed to create a filter like that using shaderparms?<br />when using the color keyword, white parts get colored, the only way I could imagine this to work is with 2 stages just for the filter, one for the color and one for the white part.. but I dont think thats what you meant, right?</div><br /><br />It would be useful (to me at least) if you described what it is you are trying to achieve; in words - without reference to channels, alphas etc. "I have a model and I want to texture it in this way..." sort of thing. Mockup results may be useful too.</div>]]></body></post><post id="p199620" date="Posted: Sat May 31, 2008 10:26 am "><author>LDAsh</author><body><![CDATA[<div class="postbody">Doom3 engine is very specific about how it does alphas anyway, you need to keep in mind if you expect your surface to glow-in-the-dark and be seen straight through fog or not.  If those 2 factors aren't an issue, you can do a lot.  If you care about light and fog, however, you are restricted to just a couple of methods and you can probably just forget all about any fancy blends, you probably have the wrong engine.  And especially if you expect bumpmapping on your surface, you will go around in circles until you finally join the rest of us here at Station Alphatest. <img src="https://web.archive.org/web/20081121083022im_/http://www.doom3world.org/phpbb2/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br />If you figure out how to softly blend one alpha'd bumpmapped surface into another, you will be famous among idtech4 developers forever.</div>]]></body></post><post id="p199621" date="Posted: Sat May 31, 2008 10:42 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">ok, I have a model, which has a basic skin. this skin is used om the diffusemap.<br />then I have 3 parts on the skin, which I want to color dynamicly, i.e. I set shaderparms via game dll.<br />they use the same skin(not the diffusemap), but different areas which should get colored.<br /><br />@LDAsh: That's ok, bumpmaps/lighting is supposed to go away, i.e. it should stand out.</div>]]></body></post><post id="p199623" date="Posted: Sat May 31, 2008 12:09 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">I don't understand what you call "skin"... <br /><br />1) Technically, Doom3 skins are just a way to change materials applied on a model by another material.<br />This is helpfull to have different versions of the same monster without the need to remake the exactly same model:<br />Classic IMP (grey) &lt;=&gt; Hell IMP (more orange with burned flesh)<br /><br />2) Model's skin is the way your bones are connected/applied/parented to your 3d model, in your 3d application (like max/maya/blender/etc)<br /><br />It seems you call "skin" something else, like the skin color of you character?</div>]]></body></post><post id="p199633" date="Posted: Sat May 31, 2008 2:31 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">skin is the texture you put on a model.<br />bones don't have anything to do with the skin, they change the appearance of the polygons on the model.<br />at least that's what it was in the old generation of games.<br /><br />but meh, with newer games it is hard to tell since all definitions got dumped..<br />in q3, materials where called shaders, doom3 says skins are just a replacement config for materials, whats next.. models get renamed to volumes ?</div>]]></body></post><post id="p199759" date="Posted: Mon Jun 02, 2008 10:02 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">well technically this is what I wanted, but my skins are supposed to be brightskins, so lighting should not affect them too much.</div>]]></body></post><post id="p199571" date="Posted: Thu May 29, 2008 5:37 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">hey<br />currently I'm adding a texture via blend to a model like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"> ..<br />    {<br />        nopicmip<br />        blend   blend<br />        map     models/bla.tga<br />    }<br />..</div><br />the image has its alpha channel.. but since I have multiple of these stages in one shader, which use all the same texture, just a different alpha channel, would it be possible to have the alpha channel in a different file ?</div>]]></body></post><post id="p199590" date="Posted: Fri May 30, 2008 6:06 am "><author>rich_is_bored</author><body><![CDATA[<div class="postbody">Use the <a href="https://web.archive.org/web/20081121081612/http://www.modwiki.net/wiki/MaskColor_(Material_stage_keyword)" class="postlink">maskcolor</a> and <a href="https://web.archive.org/web/20081121081612/http://www.modwiki.net/wiki/MaskAlpha_(Material_stage_keyword)" class="postlink">maskalpha</a> keywords.</div>]]></body></post><post id="p199592" date="Posted: Fri May 30, 2008 11:38 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">thanx..<br />though I can't get it to work...<br />my code:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">    {<br />        nopicmip<br />        blend   blend<br />        map     basetexture.tga<br />        color   1, 0, 0, 1 // red<br />    }<br />    // first mask<br />    {<br />        maskcolor<br />        map alpha1.tga<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        maskalpha<br />        map texture.tga<br />        color   0, 1, 0, 1 // green<br />    }<br />    // second mask<br />    {<br />        maskcolor<br />        map alpha2.tga<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        maskalpha<br />        map texture.tga<br />        color   0, 0, 1, 1 // blue<br />    }</div><br />now what happens: the blue stage is drawn all over the model, alpha images seem to be completely ignored..<br />had the alpha images as normal textures first, then I added it to the alpha channel as well, but still wouldn't work.</div>]]></body></post><post id="p199594" date="Posted: Fri May 30, 2008 12:30 pm "><author>simulation</author><body><![CDATA[<div class="postbody">Not sure that maskalpha and maskcolor will do what you want here. I think they just prevent a channel from being written to "dst".<br /><br />If your red, green and blue textures all have zeros in the alpha channel (or no perhaps no alpha?) and you could try this..<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">{<br />    blend    blend<br />    map      add(red_texture.tga, alpha.tga)<br />    rgba     1,0,0,1<br />}<br />{<br />    blend    blend<br />    map      add(green_texture.tga, alpha.tga)<br />    rgba     0,1,0,1<br />}<br />{<br />    blend    blend<br />    map      add(blue_texture.tga, alpha.tga)<br />    rgba     0,0,1,1<br />}</div>No idea of this works, I'm not in a position to test right this second.</div>]]></body></post><post id="p199595" date="Posted: Fri May 30, 2008 1:08 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">thanx, at least partial success.. it does work.. but only if both texture.tga and alpha.tga are RGBA images,<br />which costs a lot of space, any way to do it with RGB for texture.tga and Grayscale for alpha.tga ?</div>]]></body></post><post id="p199596" date="Posted: Fri May 30, 2008 1:55 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">thanx, at least partial success.. it does work.. but only if both texture.tga and alpha.tga are RGBA images,<br />which costs a lot of space, any way to do it with RGB for texture.tga and Grayscale for alpha.tga ?</div><br /><br />Probably not, if you've tried and it didn't work. When you talk of 'cost' do you mean purely on disk space? The final three compostite "map" textures will be red+alpha, green+alpha and blue+alpha and will each take up the same space irrespective of how they are generated.<br /><br />I'm pretty sure these add() maps must be created when the stage is parsed during first use of the material and don't change from that point on. The constituent four images can then be discarded from whatever resource pool manages images as they're no longer needed in their own right. I'm assuming that things work in this way, as it would explain why the scale() function will only accept constants for its scale factors; this implies a "one off" process to me.<br /><br />Edit: Just re-read your post and I think I may have missed something. Are the three "coloured" textures the same physical TGA or are you attempting to blend the RGB channels from three seperate images? I'm assuming the latter, otherwise you could just use one RGBA image for everything and this wouldn't be an issue.</div>]]></body></post><post id="p199597" date="Posted: Fri May 30, 2008 1:59 pm "><author>lowdragon</author><body><![CDATA[<div class="postbody">wouldnt it work by define an alpha stage and blend the textures in, like<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">// ..<br />{<br />blend gl_zero, gl_one<br />map makeAlpha (path/to/texture) //rgb image 1<br />}<br />{<br />blend gl_one, gl_one_minus_src_alpha<br />diffusemap (path/to/texture)<br />}<br />// ..<br /></div></div>]]></body></post><post id="p199598" date="Posted: Fri May 30, 2008 2:00 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">yeah, talking about diskspace.. I don't want my mod to grow too much in size, it is already pretty big.</div>]]></body></post><post id="p199600" date="Posted: Fri May 30, 2008 2:32 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">yeah, talking about diskspace.. I don't want my mod to grow too much in size, it is already pretty big.</div><br />Yes, I'm doing a texture elimination exercise to make EMZ smaller in the next release. Anything non-essential that was just put in "because we can" is being ditched.</div>]]></body></post><post id="p199606" date="Posted: Fri May 30, 2008 5:04 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody"><div class="quotetitle">simulation wrote:</div><div class="quotecontent">Edit: Just re-read your post and I think I may have missed something. Are the three "coloured" textures the same physical TGA or are you attempting to blend the RGB channels from three seperate images? I'm assuming the latter, otherwise you could just use one RGBA image for everything and this wouldn't be an issue.</div><br />I have one texture file, that is colored by the material, and 2 alpha files to select what is drawn in what color.<br />in other words, I want to draw different parts of one image in different colors.. so no it's not possible with one rgba file.<br /><br />@lowdragon:<br />no, doesn't work, seems like alpha is a full white image then.</div>]]></body></post><post id="p199607" date="Posted: Fri May 30, 2008 5:54 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">I have one texture file, that is colored by the material, and 2 alpha files to select what is drawn in what color.<br />in other words, I want to draw different parts of one image in different colors.. so no it's not possible with one rgba file.</div><br />I think you could achieve this with a RGBA texture that basicly represent your AColor and Bcolor in white plus the alpha channel, then you could substract 2 different "filter" passes, one for the AColor, and the other one for BColor.<br /><br />Just keep in mind that you must substract the inverted color you want:<br />Red = White - (Blue + Green) =&gt; so to make your Acolor become Red, you must "filter" a turquoise color.<br /><br />Also remember that everything that MUST NOT be affected by the filter map must be white (white will never be substracted in "filter" stages of a material)</div>]]></body></post><post id="p199609" date="Posted: Fri May 30, 2008 7:46 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">ah, now I get it.. that sounds like it could work, I'm going to try it, thanx.</div>]]></body></post><post id="p199610" date="Posted: Fri May 30, 2008 9:04 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">hm tried the following:<br />made an RGBA image, which had the alpha data from part1 in the red channel and the alpha data from part 2 in the green channel, and the alpha channel was used for the texture to be colored..<br />as long as I would want to use only predefined colors, this would probably work, but the colors I want to use here are not predefined, they are passed via shaderparms, and when I try to modify the color afterwards, then I can only get shades of red or green, depending on what channel I used for the part to be colored...<br />on the other hand, I dont have much of a clue how to use the blending functions, so I guess Im probably just too stupid to find out the right way :\<br />help?</div>]]></body></post><post id="p199611" date="Posted: Fri May 30, 2008 10:36 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">You should do something like this:<br /><!-- l --><a class="postlink-local" href="https://web.archive.org/web/20081121081612/http://www.doom3world.org/phpbb2/download/file.php?mode=view&amp;id=111">download/file.php?mode=view&amp;id=111</a><!-- l --><br />pict1.png<br />(FINAL is what you should have in D3, with a material that blend/diffuse the RGBA pict, then a Filter 1 and a Filter 2)<br /><img src="https://web.archive.org/web/20081121081612im_/http://www.doom3world.org/phpbb2/images/smilies/icon_wink.gif" alt=":wink:" title="Wink" /></div>]]></body></post><post id="p199612" date="Posted: Sat May 31, 2008 12:15 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">how am I supposed to create a filter like that using shaderparms?<br />when using the color keyword, white parts get colored, the only way I could imagine this to work is with 2 stages just for the filter, one for the color and one for the white part.. but I dont think thats what you meant, right?</div>]]></body></post><post id="p199618" date="Posted: Sat May 31, 2008 8:30 am "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">how am I supposed to create a filter like that using shaderparms?<br />when using the color keyword, white parts get colored, the only way I could imagine this to work is with 2 stages just for the filter, one for the color and one for the white part.. but I dont think thats what you meant, right?</div><br /><br />It would be useful (to me at least) if you described what it is you are trying to achieve; in words - without reference to channels, alphas etc. "I have a model and I want to texture it in this way..." sort of thing. Mockup results may be useful too.</div>]]></body></post><post id="p199620" date="Posted: Sat May 31, 2008 10:26 am "><author>LDAsh</author><body><![CDATA[<div class="postbody">Doom3 engine is very specific about how it does alphas anyway, you need to keep in mind if you expect your surface to glow-in-the-dark and be seen straight through fog or not.  If those 2 factors aren't an issue, you can do a lot.  If you care about light and fog, however, you are restricted to just a couple of methods and you can probably just forget all about any fancy blends, you probably have the wrong engine.  And especially if you expect bumpmapping on your surface, you will go around in circles until you finally join the rest of us here at Station Alphatest. <img src="https://web.archive.org/web/20081121081612im_/http://www.doom3world.org/phpbb2/images/smilies/icon_razz.gif" alt=":P" title="Razz" /><br />If you figure out how to softly blend one alpha'd bumpmapped surface into another, you will be famous among idtech4 developers forever.</div>]]></body></post><post id="p199621" date="Posted: Sat May 31, 2008 10:42 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">ok, I have a model, which has a basic skin. this skin is used om the diffusemap.<br />then I have 3 parts on the skin, which I want to color dynamicly, i.e. I set shaderparms via game dll.<br />they use the same skin(not the diffusemap), but different areas which should get colored.<br /><br />@LDAsh: That's ok, bumpmaps/lighting is supposed to go away, i.e. it should stand out.</div>]]></body></post><post id="p199623" date="Posted: Sat May 31, 2008 12:09 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">I don't understand what you call "skin"... <br /><br />1) Technically, Doom3 skins are just a way to change materials applied on a model by another material.<br />This is helpfull to have different versions of the same monster without the need to remake the exactly same model:<br />Classic IMP (grey) &lt;=&gt; Hell IMP (more orange with burned flesh)<br /><br />2) Model's skin is the way your bones are connected/applied/parented to your 3d model, in your 3d application (like max/maya/blender/etc)<br /><br />It seems you call "skin" something else, like the skin color of you character?</div>]]></body></post><post id="p199633" date="Posted: Sat May 31, 2008 2:31 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">skin is the texture you put on a model.<br />bones don't have anything to do with the skin, they change the appearance of the polygons on the model.<br />at least that's what it was in the old generation of games.<br /><br />but meh, with newer games it is hard to tell since all definitions got dumped..<br />in q3, materials where called shaders, doom3 says skins are just a replacement config for materials, whats next.. models get renamed to volumes ?</div>]]></body></post><post id="p199637" date="Posted: Sat May 31, 2008 3:08 pm "><author>LDAsh</author><body><![CDATA[<div class="postbody">Yeah, "skins" were "textures on models" for Quake 2, official terminology from the game itself.  It's hard to keep up sometimes.<br /><br />Are there any examples of what you're trying to do in some other games?  I think I understand now what you want, and maybe how to do it, but not as optimised as you might like it.  You may need to use 3 different images for your different circles.  Also, I don't understand the relation between "blend skin" and "final", it seems like you want a double-transparency, one draws to background and one draws to a different texture?  I'm pretty sure that's impossible, you'd need some kind of "matte" shader to draw 2 different transparencies, let alone doing it in just 1 material.  You might need to settle on using 3 different blends and 3 different images.<br /><br />Maybe if you upload your assets and mockup for us to check out, there might be a better solution.</div>]]></body></post><post id="p199641" date="Posted: Sat May 31, 2008 4:07 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">I'll try to explain it with math equation:<br />finalimage = diffusemap + BlendA * BlendSkin + BlendB * BlendSkin + BlendC * BlendSkin.<br />so I want the Blendskin to be added (with a color) to the final image, but only the parts that are specified via blendA/B/C<br />sorry, this is hard to explain..<br />I'll try it this way:<br />imagine the diffusemap was a wall texture, and BlendSkin would have these 3 words on it: Give, Me, Money.<br />now the BlendA texture would have white pixels at the position of the word Give, same for BlendB =&gt; Me, and BlendC =&gt; Money.<br />Now the final image would produce a wall texture with the 3 words on it, but each word in a different color.</div>]]></body></post><post id="p199646" date="Posted: Sat May 31, 2008 4:53 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">So what's wrong with a brick diffuse map, and 3 add maps for Give, Me and Money with parms for RGB values?<br />(Where the words are white on black, and parms define their colors)</div>]]></body></post><post id="p199657" date="Posted: Sat May 31, 2008 7:18 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">the size of it is the problem.. if I do it this way I need 4 32bit tga files, which are 4megs each.<br />it is a waste of space having 4 32bit tga files when all I use is the 3 alpha channels and one rgb(24bit) image.</div>]]></body></post><post id="p199685" date="Posted: Sun Jun 01, 2008 8:59 am "><author>6th Venom</author><body><![CDATA[<div class="postbody">You can't use multiple different alpha on a single material in D3/Q4 (i think).<br />But why would you need alphas on materials' Add stages?<br /><br />If i remember correctly, if you define diffusemap first (the one with the alpha channel), every material' stages after will "use" this alpha.<br />Just look at some D3 materials used on mapobjects that only have an alpha on the diffusemap, and not on the specular / bumpmap.</div>]]></body></post><post id="p199686" date="Posted: Sun Jun 01, 2008 9:15 am "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">ok, I have a model, which has a basic skin. this skin is used om the diffusemap.<br />then I have 3 parts on the skin, which I want to color dynamicly, i.e. I set shaderparms via game dll.<br />they use the same skin(not the diffusemap), but different areas which should get colored.<br /><br />@LDAsh: That's ok, bumpmaps/lighting is supposed to go away, i.e. it should stand out.</div><br /><br />So you're using 9 shaderparms to color the area marked as "Blend A", "Blend B" and "Blend C" with three different RGB values? Where does the color for the rest of the surface come from, or do "A", "B" and "C" constitute all of it?</div>]]></body></post><post id="p199687" date="Posted: Sun Jun 01, 2008 9:41 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">&gt;So you're using 9 shaderparms to color the area marked as "Blend A", "Blend B" and "Blend C" with three different RGB values?<br />Yes!<br /><br />&gt;Where does the color for the rest of the surface come from, or do "A", "B" and "C" constitute all of it?<br />Well first layer is a diffusemap, which is precolored, no dynamic coloring needed.<br />Then the 3 color layers will be added on top of the diffusemap.<br /><br />edit: current code looks like this:<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">models/mytex<br />{<br />    noSelfShadow<br />    unSmoothedTangents<br /><br />    {<br />        nopicmip<br />        blend   diffusemap<br />        map   models/mytex_d.tga<br />    }<br /><br />    bumpmap addnormals ( models/mytex_local.tga, heightmap ( models/mytex_h.tga, 2 ))<br />    specularmap   models/mytex_s.tga<br /><br />    {<br />        nopicmip<br />        blend blend<br />        map add(models/mytex_maskbase.tga, models/mytex_mask1.tga)<br />        color   Parm0, Parm1, Parm2, Parm11<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        map add(models/mytex_maskbase.tga, models/mytex_mask2.tga)<br />        color   Parm3, Parm4, Parm5, Parm11<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        map add(models/mytex_maskbase.tga, models/mytex_mask3.tga)<br />        color   Parm8, Parm9, Parm10, Parm11<br />    }<br />}</div><br />Technically it works perfect, but it takes up too much hdd space</div>]]></body></post><post id="p199694" date="Posted: Sun Jun 01, 2008 1:02 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Are the Dynamic A B C colors only fading colors (Red to black, black to Red), or let say A is Red and go to Blue then to Purple etc?<br />If it the first case, you probably could use only one parm with maths for each add stages.<br /><br />Could we see what looks like models/mytex_maskbase.tga and models/mytex_mask1.tga?<br />Did you tried to just remove the alpha channel of A B C and try like that?<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">    {<br />        nopicmip<br />        blend add<br />        map models/mytex_maskbase2.tga<br />        color   Parm3, Parm4, Parm5, Parm11<br />    }<br /></div></div>]]></body></post><post id="p199695" date="Posted: Sun Jun 01, 2008 1:08 pm "><author>simulation</author><body><![CDATA[<div class="postbody">If you combine the three "masks" into an RGB so you could try something like this...<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">models/mytex<br />{<br />    noSelfShadow<br />    unSmoothedTangents<br /><br />    {<br />        nopicmip<br />        blend   diffusemap<br />        map   models/mytex_d.tga<br />    }<br /><br />    bumpmap addnormals ( models/mytex_local.tga, heightmap ( models/mytex_h.tga, 2 ))<br />    specularmap   models/mytex_s.tga<br /><br />    {<br />        nopicmip<br />        blend blend<br />        // use the red channel for this stage<br />        map makeAlpha(scale(models/mytex_RGBmask.tga,1,0,0,1))<br />        color   Parm0, Parm1, Parm2, Parm11<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        // use the green channel for this stage<br />        map makeAlpha(scale(models/mytex_RGBmask.tga,0,1,0,1))<br />        color   Parm3, Parm4, Parm5, Parm11<br />    }<br />    {<br />        nopicmip<br />        blend blend<br />        // use the blue channel for this stage<br />        map makeAlpha(scale(models/mytex_RGBmask.tga,0,0,1,1))<br />        color   Parm8, Parm9, Parm10, Parm11<br />    }<br />}<br /></div><br />You may need to mess with the values in 'scale' because makeAlpha() is an average, so you may need to scale them by three instead of one to counter balance that.<br /><br />Sim</div>]]></body></post><post id="p199726" date="Posted: Mon Jun 02, 2008 8:44 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">@6th Venom:<br />A/B/C can get any rgb values.<br />Problem with 'blend add' is, that it does not take alpha into account, but it depends on how black the pixel is.<br />But I want dark colors to be possible too.<br /><br />here's what the images look like:<br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/diffuse.jpg" class="postlink">Diffusemap</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/blendskin.jpg" class="postlink">Blend Skin</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/blend_a.jpg" class="postlink">Blend A</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/blend_b.jpg" class="postlink">Blend B</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/blend_c.jpg" class="postlink">Blend C</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/result.jpg" class="postlink">This is the result I want</a><br /><br />@simulation:<br />nice idea, but it does not add much, i.e. it looks like it has very low alpha. and when I raise the scale to 3, it somehow loses information, stuff that was colored with scale 1 is not colored anymore.<br /><br />looks like this:<br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/blend_rgb.jpg" class="postlink">RGB Blend Texture</a><br /><a href="https://web.archive.org/web/20081121080428/http://gtr.quakedev.com/d3w/result_rgb.jpg" class="postlink">Resulting Image</a> (scale 1)</div>]]></body></post><post id="p199730" date="Posted: Mon Jun 02, 2008 9:29 am "><author>LDAsh</author><body><![CDATA[<div class="postbody">In terms of decals, this blend will do darks and brights together using middle-gray as transparent -  "blend 	GL_DST_COLOR, GL_SRC_COLOR"  (may need "translucent"/"decal_macro" keywords in the material though)<br />I don't think you will get this multiple alpha thing working, to be honest, but I've never tried anything like this either.  You are actually using it for player colour customisations on the vanilla Q4 characters?  That would explain why you can't layer the conflicting materials, and why you want to keep the texture use down.  It's a very interesting concept, if it ends up working.</div>]]></body></post><post id="p199731" date="Posted: Mon Jun 02, 2008 9:54 am "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">&gt;In terms of decals, this blend will do darks and brights together using middle-gray as transparent...<br />hm that sounds like I would have to predefine which colors would be dark, and which bright..<br /><br />&gt;You are actually using it for player colour customisations on the vanilla Q4 characters? <br />Not just vanilla characters, but yeah<br /><br />&gt;It's a very interesting concept, if it ends up working.<br />well as said, it does already work, but it needs 32bit images for Blend Skin,Blend A/B/C, which is 128bits total, while the actually used bits are only 48.<br />and with 1024x1024px tga files, this is 6MB vs 16MB (and this is with dds files not taken into account yet)</div>]]></body></post><post id="p199737" date="Posted: Mon Jun 02, 2008 12:05 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">@simulation:<br />nice idea, but it does not add much, i.e. it looks like it has very low alpha. and when I raise the scale to 3, it somehow loses information, stuff that was colored with scale 1 is not colored anymore.</div><br /><br />How about applying a scale() after the makeAlpha() too?<br /><br /><br />scale(makeAlpha(scale(filename.tga,1,0,0,1)),1,1,1,3) ?</div>]]></body></post><post id="p199741" date="Posted: Mon Jun 02, 2008 3:04 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">nice, that seems to work.. I get a few artifacts, but that might be due to the quickly made rgb image.<br />I will rebuild it more clean and tell you if it's good.<br />Thanks  <img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/images/smilies/icon_smile.gif" alt=":)" title="Smile" /></div>]]></body></post><post id="p199745" date="Posted: Mon Jun 02, 2008 4:25 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">Remember seen that?<br /><a href="https://web.archive.org/web/20081121080428/http://img176.imageshack.us/my.php?image=shot00006.jpg" class="postlink"><img src="https://web.archive.org/web/20081121080428im_/http://img176.imageshack.us/img176/9452/shot00006.th.jpg" alt="Image" /></a><br /><a href="https://web.archive.org/web/20081121080428/http://img509.imageshack.us/my.php?image=shot00003gc1.jpg" class="postlink"><img src="https://web.archive.org/web/20081121080428im_/http://img509.imageshack.us/img509/1387/shot00003gc1.th.jpg" alt="Image" /></a><br />(from my mainmenu...)<br /><br />The player's material's code was...<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">models/characters/marine/vmarine_default<br />{<br />   noSelfShadow<br />   unsmoothedTangents<br />   flesh<br />   forceOverlays<br />   clamp<br />   collision<br /><br />   {   // burning corpse effect<br />      if   parm7         // only when dead<br />      // make a burned away alpha test for the normal skin<br />      blend   gl_zero, gl_one         // don't draw anything<br />      <br />      map models/monsters/spectre/dis2.tga   // replace this with a monster-specific texture<br />      alphaTest 0.05 + 1.7 * (time - parm7)<br />   }<br /><br />        diffusemap     models/characters/menu_mplayer/marine_color0.tga<br /><br />   {<br />      blend   diffusemap<br />      <br />      map     models/characters/menu_mplayer/marine_color1.tga<br />                red     0.59<br />                green   0.54<br />                blue    0.37<br />   }<br /><br />   {<br />      blend   diffusemap<br />      <br />      map     models/characters/menu_mplayer/marine_color2.tga<br />                red     0.14<br />                green   0.14<br />                blue    0.14<br />   }<br /><br />   bumpmap        addnormals(models/characters/male_npc/marine/marine_local.tga, heightmap(models/characters/male_npc/marine/marine_h.tga, 10 ) )<br /><br />   {<br />      blend   specularmap<br />      <br />      map     models/characters/male_npc/marine/marine_s.tga<br />                red     1<br />                green   1<br />                blue    1<br />   }<br /><br />   {<br />      blend   specularmap<br />      <br />      map     models/characters/male_npc/marine/marine_s.tga<br />                red     1<br />                green   1<br />                blue    1<br />   }<br /><br />}<br /><br />...and...<br /><br />models/characters/marine/vmarine_orange1<br />{<br />   noSelfShadow<br />   unsmoothedTangents<br />   flesh<br />   forceOverlays<br />   clamp<br />   collision<br /><br />   {   // burning corpse effect<br />      if   parm7         // only when dead<br />      // make a burned away alpha test for the normal skin<br />      blend   gl_zero, gl_one         // don't draw anything<br />      <br />      map models/monsters/spectre/dis2.tga   // replace this with a monster-specific texture<br />      alphaTest 0.05 + 1.7 * (time - parm7)<br />   }<br /><br />        diffusemap     models/characters/menu_mplayer/marine_color0.tga<br /><br />   {<br />      blend   diffusemap<br />      <br />      map     models/characters/menu_mplayer/marine_color1.tga<br />                red     0.5<br />                green   0.3<br />                blue    0.05<br />   }<br /><br />   {<br />      blend   diffusemap<br />      <br />      map     models/characters/menu_mplayer/marine_color2.tga<br />                red     0.35<br />                green   0.2<br />                blue    0.05<br />   }<br /><br />   bumpmap        addnormals(models/characters/male_npc/marine/marine_local.tga, heightmap(models/characters/male_npc/marine/marine_h.tga, 10 ) )<br /><br />   {<br />      blend   specularmap<br />      <br />      map     models/characters/male_npc/marine/marine_s.tga<br />                red     1<br />                green   1<br />                blue    1<br />   }<br /><br />   {<br />      blend   specularmap<br />      <br />      map     models/characters/male_npc/marine/marine_s.tga<br />                red     1<br />                green   1<br />                blue    1<br />   }<br /><br />}<br /></div><br />...and as you noticed, multiple declarations of diffuse, specular and bump are OK!<br />the only problem is that the game multiply/add each declaration's color by the others, so i used the same textures as your A B C, and red+black+black=red, black+blue+black=blue, etc...<br /><br />...and light interactions work like usually. (not like with blend)<br /><br />Edit: Download my mod and look at textures, materials etc to understand it better if needed.</div>]]></body></post><post id="p199747" date="Posted: Mon Jun 02, 2008 6:32 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">nice, though not what I need.<br />@simulation:<br />there is a problem with slightly overlapping color channels, those pixels get a mixed color,<br />which is at some points pretty obvious and ugly to look at, but It should be possible to remove those, just a lot of work <img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>]]></body></post><post id="p199750" date="Posted: Mon Jun 02, 2008 7:46 pm "><author>simulation</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">nice, though not what I need.<br />@simulation:<br />there is a problem with slightly overlapping color channels, those pixels get a mixed color,<br />which is at some points pretty obvious and ugly to look at, but It should be possible to remove those, just a lot of work <img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div><br /><br />Yeah, coders doing texture editing is never a joy to behold <img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/images/smilies/icon_wink.gif" alt=";)" title="Wink" /> I have that pleasure to come on the RGB skins and proskins for my new player models soon!<br /><br />On the subject of mutiple/repeated stages there is a good description of how the renderer handles them on <a href="https://web.archive.org/web/20081121080428/http://www.iddevnet.com/doom3/" class="postlink">http://www.iddevnet.com/doom3/</a> (scroll down to "11/12/04 Rendering Order").<br /><br />Sim</div>]]></body></post><post id="p199751" date="Posted: Mon Jun 02, 2008 7:54 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody"><div class="quotetitle">TTK-Bandit wrote:</div><div class="quotecontent">nice, though not what I need.</div><br />Sorry for missunderstood so, cause i really thought that you tried to have 3 separates textures (and/or colors) shared by the same model (player), and dynamicly customizable by players... like so:<br /><div class="attachtitle">Attachment:</div><div class="attachcontent">			<img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/download/file.php?id=114" alt="shot00002.png" /><br /><span class="gensmall">shot00002.png [ 253.37 KB | Viewed 259 times ]</span>
		
		<br /></div><br />That's what i did.<br /><br />So, you try to do something like that but absolutly "blended"?</div>]]></body></post><post id="p199752" date="Posted: Mon Jun 02, 2008 8:10 pm "><author>simulation</author><body><![CDATA[<div class="postbody">Yes, this IS what Bandit is doing. But he does not want the disk space cost of having individual TGA and DDS files for every map.<br /><br />One question Venom (I can't check your mod again now, I'm not at my desktop) but how do you handle having two selectable colour elements in an "assets only" mod - i.e., without SDK changes to allow different values for ui_skin and mod_validSkins?</div>]]></body></post><post id="p199754" date="Posted: Mon Jun 02, 2008 8:28 pm "><author>6th Venom</author><body><![CDATA[<div class="postbody">I... do not!<br />This technique was made while i was thinking of making a Denton version with some skin modifications to allow Clans to choose "more" colors / combinations.<br />In a time i was also thinking of a way to secretly put the 2 colors informations at the start of the player's name like:<br /><br />Name= "^1^6^06th Venom"<br /><br />where ^1 is the firstcolor and ^6 the secondcolor.<br />^0 just bring back colors to normal before displaying the "real" player's name as "6th Venom" for other players.<br /><br />Somehow, the mainmenu and Guis would have catch these 2 colors and displayed these.<br /><br />...i never go further.  <img src="https://web.archive.org/web/20081121080428im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>]]></body></post><post id="p199759" date="Posted: Mon Jun 02, 2008 10:02 pm "><author>TTK-Bandit</author><body><![CDATA[<div class="postbody">well technically this is what I wanted, but my skins are supposed to be brightskins, so lighting should not affect them too much.</div>]]></body></post></posts></thread></xml>
