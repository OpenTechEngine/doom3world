<?xml version="1.0" encoding="UTF-8"?>
<xml><thread id="214"><title>Make your own custom gun: the hellfire cannon</title><posts><post id="p1501" date="Posted: Tue Nov 12, 2002 11:19 pm "><author>vector</author><body><![CDATA[<div class="postbody">I slapped together a quick superweapon as a test.  All you have to do to try it out is add some text to three script files.  These changes will add a new weapon to the game, not modify an existing weapon.  To be safe, you may want to back up your script files beforehand.
<br /><br />First, create a new projectile definition by adding the following code to <span style="color: red">projectiles.def</span>:
<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">entityDef projectile_hellfireball {<br />   "spawnclass"            "idProjectile"<br />   "mins"                  "-3.5 -3.5 -3.5"<br />   "maxs"                  "3.5 3.5 3.5"<br />   //"model"                "models/weapons/impfireball/impfireball.lwo"<br /><br />   "model"                  "models/weapons/impfireball/anims/tumble.md5mesh"<br />   "anim idle"               "models/weapons/impfireball/anims/flight.md5anim"<br />   "anim growth"            "models/weapons/impfireball/anims/growth.md5anim"<br />   "anim flight"            "models/weapons/impfireball/anims/tumble.md5anim"<br />                  <br />   "s_shader"               "player_rocket"<br />                        <br />   "damage"               "damage_missileDirect"<br />   "splash_damage"               "damage_missileSplash"<br />                        <br />   "health"               "5"               // amount of damage projectile can take if damaged (0 means it can't be destroyed)<br />   "velocity"               "1500 0 0"         // how fast the projectile leaves the gun (or distance if fuse is 0)<br />   "angular_velocity"         "0 0 0"            // how the projectile is rotating when it leaves the gun<br />   "thrust"               "5"               // the rate of acceleration (always in the direction of the projectiles model)<br />   "thrust_start"            "0"               // when to start accelerating<br />   "thrust_end"            "0"               // when to stop accelerating<br />   "linear_friction"         "0"               // "air" friction<br />   "angular_friction"         "0"<br />   "contact_friction"         "0"<br />   "bounce"               "1"               // how much speed a projectile retains when it bounces off of objects (coefficient of restitution).  0 means no bounce.<br />   "mass"                  "5"<br />   "gravity"               "5"            // how much gravity affects the trajectory.  gravity direction is same as the entity that fired it.<br />   "fuse"                  "30"            // how long before the projectile is removed or self-detonates.  Use 0 for beam weapons (velocity == distance).<br />                        <br />   "detonate_on_fuse"         "1"               // whether projectile should detonate when it's fuse runs out<br />   "detonate_on_death"         "1"               // whether projectile should detonate when it's "killed" (health runs out)<br />   "detonate_on_world"         "1"               // whether projectile should detonate when it hits an obstacle<br />   "detonate_on_actor"         "1"               // whether projectile should detonate when it hits a character in the game<br />                        <br />   "impact_blood"            "0"               // whether projectile causes blood splats from characters that bleed<br />   "impact_gib"            "1"               // whether projectile can gib a character or not (for example: bullets don't gib, but rockets do)<br />                        <br />   "decal_bounce"            ""               // decal to leave on world when bounces<br />   "decal_detonate"         "textures/decals/ballburn01"<br />   "decal_size"            "75" <br /><br />                        <br />   "fx_fly"               "particles/firetrail.particle"               // particle effect while in the air<br />   "fx_fly2"               "particles/fireballsmoke.particle"            // particle effect while in the air<br />   "fx_fly3"               "particles/firetrailembers.particle"         // particle effect while in the air<br />   "fx_detonate"            "particles/fireballexplosion.particle"         // particle effect when detonates<br />   "fx_detonate2"            "particles/fireballsmoke2.particle"            // particle effect when detonates<br />   "fx_residue"            "particles/firetrailembers2.particle"         // particle effect while in the air<br />   "fx_bounce"               ""               // particle effect when bounces<br />   "fx_fuse"               "particles/bigsparks.particle"               // particle effect when removed from fuse expiring<br />                        <br />   "light_shader"            "lights/impflash"<br />   "light_color"            "1 .8 .6"<br />   "light_radius"            "300"<br />//   "light_offset"            "-8 0 -20"<br />   "light_offset"            "0 0 0"<br /><br /><br /><br />   "detonate_light_shader"      "lights/impflash"<br />   "detonate_light_color"      "1 .8 .6"<br />   "detonate_light_radius"      "500"<br />   "detonate_light_removetime"   "1.0"<br /><br />   "snd_explode"            "monster_demon_imp_fireball_explode"<br />   "snd_fly"               "monster_demon_imp_fireball_flight"               // particle effect while in the air<br />}</div><br /><br />Then create a new weapon definition (to use the particle definition) by adding the following code to<span style="color: red"> weapons.def</span>:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">entityDef weapon_hellfirecannon {<br />   "editor_color"         ".3 .3 1"<br />   "editor_mins"         "-16 -16 0"<br />   "editor_maxs"         "16 16 32"<br /><br />   "editor_usage"         ""<br /><br />   "spawnclass"         "idItem"<br />   "size"               "32 32 32"<br />   "model"             "models/weapons/pistol/pistol_world.ase"<br />   "viewmodel"          "models/weapons/pistol/fred/cycles/idle.md5mesh"<br />   "anim idle"          "models/weapons/pistol/fred/cycles/idle.md5anim"<br />   "anim fire1"          "models/weapons/pistol/fred/cycles/fire1.md5anim"<br />   "anim fire2"          "models/weapons/pistol/fred/cycles/fire2.md5anim"<br />   "anim fire3"          "models/weapons/pistol/fred/cycles/fire3.md5anim"<br />   "anim fire4"         "models/weapons/pistol/fred/cycles/fire4.md5anim"<br /><br />   "anim putaway"         "models/weapons/pistol/fred/cycles/put_away.md5anim"<br />   "anim raise"         "models/weapons/pistol/fred/cycles/raise2.md5anim"<br />   "anim reload"         "models/weapons/pistol/fred/cycles/reload_empty.md5anim"<br />   "anim noammo"         "models/weapons/pistol/fred/cycles/empty_reload_start.md5anim"<br />   "action"            "sound/electronics/1shot_beep_02.wav"<br />   "inv_message"         "Picked up a Hellfire Cannon"<br />   "inv_weapon"         "weapon_hellfirecannon"<br />   "inv_ammo_bullets"      "200"<br />   "icon"               "guis/assets/hud/wpn_1"<br /><br />   "weaponname"         "Hellfire Cannon"<br />   "projectile"         "projectile_hellfireball"<br />   "numProjectiles"      "1"<br />   "spread"            "0" // "1"<br />   "ammoType"            "ammo_bullets"<br />   "ammoRequired"         "1"<br />   "clipSize"            "200"<br />   "fireRate"            "0.00"<br />   "continuousFire"      "0"<br />   "dryFireReload"       "1"<br />   "switchWhenEmpty"      "0"<br />   "flashShader"         "muzzleflash"<br />   "flashColor"         "1 0.8 0.6"<br />   "flashRadius"         "500"<br /><br />   //"recoilTime"         "125"<br />   //"recoilAngles"      "-1 -1 0"<br /><br />   "recoilTime"         "125"<br />   "recoilAngles"         "-1 0 0"<br /><br /><br /><br /><br />   "ejectParticles"      "particles/smokepuff.particle"<br />   "ejectParticleBone"      "barrel"<br />   "barrelParticles"      "particles/smoketrail.particle"<br />   "barrelParticleBone"      "barrel"<br />   "barrelSmokeDelay"      "150"<br />   "barrelSmokeLength"      "0"<br />   "barrelPressure"      "300"<br />   <br />   //"frame idle:1"      "sound snd_idle"<br />   "frame raise:1"         "sound snd_raise"<br />   "frame fire1:1"         "sound snd_fire"<br />   "frame fire2:1"         "sound snd_fire"<br />   "frame fire3:1"         "sound snd_fire"<br />   "frame fire4:1"         "sound snd_fire"<br />   "frame noammo:1"      "sound snd_empty"<br />   "frame reload:1"      "sound snd_reload"<br />   "frame putaway:1"      "sound snd_putaway"<br /><br /><br />   "snd_raise"            "player_pistol_raise"<br />   //snd_raise"            "nosound"<br />   "snd_fire"            "player_pistol_fire"<br />   "snd_reload"         "player_pistol_reload"<br />   "snd_empty"            "player_pistol_empty"<br />   "snd_putaway"         "player_pistol_putaway"<br />   //"snd_putaway"         "nosound"<br /><br />   "snd_idle"            ""<br />   "snd_explode"         ""<br />   "snd_bounce"         ""<br />   "snd_windown"         ""<br />   "snd_windup"         ""<br />}</div><br /><br />Finally, register the weapon in <span style="color: red">player.def </span>by adding the new weapon to the 12th weapon slot:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">"weapon12"      "weapon_hellfirecannon"</div><br /><br />This illustrates the basics of creating a new doom weapon.  Most of the settings are pretty self-explanetory.  This weapon is a very powerful rocket-like projectile and uses the Imp fireball shader effects.  To use the weapon in game, simply call the following from the console:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">give weapon_hellfirecannon</div><br /><br />And to reload the entity definitions in game, simply call:<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">reloadEntityDefs</div>
<br /><br />Please note that you will have to reload the entities, switch weapons, and then switch back to your modified weapon to see changes made to the configuration.  
<br /><br />Have fun!</div>]]></body></post><post id="p1599" date="Posted: Wed Nov 13, 2002 9:57 pm "><author>BNA!</author><body><![CDATA[<div class="postbody">Just to add to vectors mini tutorial:
<br /><br />It's enough to store all the values in one single .def file, in this case just name it "wpn_hellfire.def", drop it in the def dir and that's it (+ adding the weapon into a slot in the player.def.
<br />Alternertively you can zip it including the directory structure, rename it to .pk4 and drop it into your base dir.</div>]]></body></post><post id="p2774" date="Posted: Sun Dec 01, 2002 7:58 pm "><author>Ghost</author><body><![CDATA[<div class="postbody">dont worx for me
<br /><br />there is not :     "models/weapons/impfireball/impfireball.lwo" 
<br />                       "particles/smokepuff.particle" 
<br />                       "particles/smoketrail.particle"  
<br />                       "barrel"</div>]]></body></post><post id="p2778" date="Posted: Sun Dec 01, 2002 8:26 pm "><author>BNA!</author><body><![CDATA[<div class="postbody">In this case edit the file contents to match up your paths or def names.</div>]]></body></post><post id="p2783" date="Posted: Sun Dec 01, 2002 8:33 pm "><author>Ghost</author><body><![CDATA[<div class="postbody">i cant match a path to an non-existent file
<br />ive checked my folders and i dont have this files
<br /><img src="https://web.archive.org/web/20100522163257im_/http://www.doom3world.org/phpbb2/images/smilies/icon_question.gif" alt=":?:" title="Question" /></div>]]></body></post><post id="p2786" date="Posted: Sun Dec 01, 2002 8:45 pm "><author>BNA!</author><body><![CDATA[<div class="postbody"><div class="quotetitle">Ghost wrote:</div><div class="quotecontent">i cant match a path to an non-existent file<br />ive checked my folders and i dont have this files<br /><img src="https://web.archive.org/web/20100522163257im_/http://www.doom3world.org/phpbb2/images/smilies/icon_question.gif" alt=":?:" title="Question" /></div>
<br /><br />If you can see an imp throwing fireballs at you in e3_3, you have the files.</div>]]></body></post><post id="p3103" date="Posted: Tue Dec 10, 2002 2:40 am "><author>BNA!</author><body><![CDATA[<div class="postbody">testing &amp; restoring</div>]]></body></post><post id="p26728" date="Posted: Tue Jul 20, 2004 9:45 pm "><author>Eggy</author><body><![CDATA[<div class="postbody">Just a quick tip. Instead of copying over the whole entity you wish to replicate you can use the "inherit" tag to take all the information from the stated entity and then only change what you want.
<br /><br />Heres an example for the projectile_hellfirecannon
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">entityDef projectile_hellfireball {<br />   "inherit"                    "projectile_impfireball"<br />   "damage"                     "damage_missileDirect"<br />   "splash_damage"              "damage_missileSplash"<br />   "velocity"                   "1500 0 0"<br />   "thrust"                     "5"<br />   "bounce"                     "1"<br />   "gravity"                    "5"<br />   "fuse"                       "30"<br />   "light_color"                "1 .8 .6"<br />   "light_radius"               "300"<br />   "detonate_light_color"       "1 .8 .6"<br />   "detonate_light_radius"      "500"<br />   "detonate_light_removetime"  "1.0"<br />}</div>
<br /><br />Comments were removed to preserve formatting.
<br /><br />Hope this is helpful to someone. Once you start to get a basic set of weapons made you will find you can inherit those into most other weapons. This has helped me to cut development time. Nice tut tho vector, this is what got me started <img src="https://web.archive.org/web/20100522163257im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>]]></body></post><post id="p37233" date="Posted: Tue Aug 17, 2004 8:21 pm "><author>davey1971</author><body><![CDATA[<div class="postbody">Can't get this to work.
<br /><br />Error message is "Error: Unknown weapon 'weapon_hellFirecannon'
<br /><br />I created one file called "weapon_hellfirecannon.def"
<br /><br />I placed the projectiles.def code and the weapons.def code into this file.
<br /><br />I saved the file and added the file to the pak000.pk4 file.
<br /><br />I modified the player.def file in the pak000.pk4 file, to include:
<br /><br />"weapon12"      "weapon_hellfirecannon"
<br /><br />However, when I did this I received an error related to "weapon_pda". EDIT: when I ran Doom3.
<br /><br />So, I made the following entry in the player.def file
<br /><br />	"def_weapon16"                                          "weapon_hellfirecannon"
<br />	"weapon10_best"						"0"
<br />	"weapon10_cycle"					"1"
<br />	"weapon10_toggle"					"0"
<br />	"weapon10_allowempty"				"1"
<br /><br />right after the def_weapon15 entry.
<br /><br /><br />I loaded a map and typed "give weapon_hellfirecannon" (with out the quotes) and that is when I get the Unknown weapon error
<br /><br />What am I doing wrong?
<br /><br />I looked in the pk4 file, and there seems to be scripts for each weapon.
<br /><br />Do you not have to make a script file for the new weapon?
<br /><br />Thanks for any help.</div>]]></body></post><post id="p37235" date="Posted: Tue Aug 17, 2004 8:35 pm "><author>waterboy4800</author><body><![CDATA[<div class="postbody">Had the same problem
<br /><br />Weapon 12 is the PDA, thats the error you get, you'd have to remove PDA to stick it in the 12th spot
<br /><br />no such thing as a 16th weapon set it between 13th and 15th spot, here was my modified player def that didnt give me the error
<br /><br /><div class="codetitle"><b>Code:</b></div><div class="codecontent">   "def_weapon13"                  "weapon_grenadelauncher"<br />   "weapon13_best"                  "0"<br />   "weapon13_cycle"               "1"<br />   "weapon13_toggle"               "0"<br />   "weapon13_allowempty"                    "1"<br /></div></div>]]></body></post><post id="p39134" date="Posted: Fri Aug 20, 2004 8:56 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">I've just extracted the whole of the def folder, and there's no weapons.def or projectiles.def :S
<br /><br />Is it somewhere else I put this code? Or have I got missing files in my Doom 3??</div>]]></body></post><post id="p39140" date="Posted: Fri Aug 20, 2004 9:06 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">I think I'll try the way BNA! suggested, I can't find those files anywhere :S</div>]]></body></post><post id="p39160" date="Posted: Fri Aug 20, 2004 9:33 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">ERROR: No 'weapon_scriptobject' set on 'weapon_hellfirecannon'.
<br /><br />Is what I get... very strange... I tried taking weapon_pistol.script and making a copy called weapon_hellfirecannon.script, but no luck, I get the same error message.
<br /><br />Can anyone let me know what I'm doing wrong??
<br /><br />I basically took the two sets of code from the original post, stuck them into weapon_hellfirecannon.def, changed the code in player.def for weapon 13 so that def_weapon13 had "weapon_hellfirecannon" there, and then loaded the game and typed "give weapon weapon_hellfirecannon" into console.</div>]]></body></post><post id="p39258" date="Posted: Sat Aug 21, 2004 1:24 am "><author>FireHawk</author><body><![CDATA[<div class="postbody">I had the same problem took me hours to work out why
<br /><br />the reason is
<br /><br />its not being loaded, so when the game looks for it it cant find it even thou it exisits...
<br /><br />it has to be refrenced in the doom_main.script to be loaded when doom loads.
<br /><br />doom_main.script is pretty straightforward just refrence your new weapon in the weaponsection.</div>]]></body></post><post id="p39418" date="Posted: Sat Aug 21, 2004 9:58 am "><author>Daaave</author><body><![CDATA[<div class="postbody">Ah excellent. Cheers a bunch.
<br /><br />Actually, I managed to get a weapon working by just downloading someone's weapon mod from fileplanet and having a look in the code.
<br /><br />It seems a bunch of entitydefs that were supposed to be in the weapon_hellfirecannon.def weren't in there either.
<br /><br />But I'll have a look at that file for the weapons section, when I get around to making weapons of my own they'll come in very handy.</div>]]></body></post><post id="p40067" date="Posted: Sun Aug 22, 2004 3:25 pm "><author>Twiglet</author><body><![CDATA[<div class="postbody">Ugh.. Sorry for bumping the topic again but I just can't get it to work...
<br /><br />So I did exactly what Daaave had done, and got the same error message, so what exactly do I need to add to the Doom.Main.Script file?
<br /><br />I would figure that i'd just add a line like:
<br /><div class="codetitle"><b>Code:</b></div><div class="codecontent"> #include "script/weapon_hellfirecannon.script" </div>
<br /><br />But when I do that it obviously comes up with an error saying about how that file doesnt exist. If i just copy and paste another weapon script file and rename it, i get all sorts of errors that prevent me from even starting up the game, and I don't think i'm quite advanced enough to be altering the script files themselves... 
<br /><br />Thanks a lot guys, I wouldnt have asked, but this seems to be the only tutorial of it's kind, and i'd really like to get the issue cleared up for me or anyone else in a similar situation.</div>]]></body></post><post id="p40075" date="Posted: Sun Aug 22, 2004 3:43 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">Basically what I did was make a copy of weapon_pistol.script and named it weapon_hellfirecannon.script, then I changed each of the functions in the script (for instance weapon_pistol::fire())  to the hellfirecannon equivalent (for instance weapon_hellfirecannon::fire()). 
<br /><br />I then added the line:
<br /><br />#include "script/weapon_hellfirecannon.script"
<br /><br />to the doom_main.script file.
<br /><br />I think your problem might have been renaming the functions.
<br /><br />Oh and I think in the end I gave up on the tutorial and created a copy of the weapon_pistol.def file, changed the name to weapon_hellfirecannon.def and changed the values for that instead.
<br /><br />It wasn't a hellfirecannon or whatever, but at least it was creating a new gun in the game.
<br /><br />I dunno. I guess I could probably make a tutorial of my own tying up all the loose ends from the other tutorial, but that might upset Vector <img src="https://web.archive.org/web/20100522163257im_/http://www.doom3world.org/phpbb2/images/smilies/icon_sad.gif" alt=":(" title="Sad" />. 
<br /><br />Plus I'm not really an experience enough modder to answer any specific questions.</div>]]></body></post><post id="p40076" date="Posted: Sun Aug 22, 2004 3:47 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">And don't worry about being experienced enough to change any of the script files, that's the beauty of it all being packed into pk4 files. If you manage to completely mess up the game, just delete the files that you extracted and changed in your base folder and the game will refer back to the default ones. <img src="https://web.archive.org/web/20100522163257im_/http://www.doom3world.org/phpbb2/images/smilies/icon_biggrin.gif" alt=":D" title="Very Happy" /></div>]]></body></post><post id="p40227" date="Posted: Sun Aug 22, 2004 9:49 pm "><author>Twiglet</author><body><![CDATA[<div class="postbody">I doubt he'd mind.. I mean, it seems he did write it in 2002, so some of it probably doesnt apply now anyways.
<br /><br />But I still can't get it to work, and I tried modifying the original tut and making a modified copy of one weapon, thanks for trying anyway tho.</div>]]></body></post><post id="p40239" date="Posted: Sun Aug 22, 2004 10:13 pm "><author>Daaave</author><body><![CDATA[<div class="postbody">Well the way I found out was by downloading this mod:
<br /><br /><!-- m --><a class="postlink" href="https://web.archive.org/web/20100522163257/http://www.doom3world.org/phpbb2/viewtopic.php?t=3740">http://www.doom3world.org/phpbb2/viewtopic.php?t=3740</a><!-- m -->
<br /><br />and seeing what this guy did, taking into account what had been said in the tutorial on this thread.
<br /><br />It might be worth checking it out in case there's anything I forgot to add.</div>]]></body></post></posts></thread></xml>
